<!--
* 
* @ Name            :   del_caseCollaborationComponent
* @ Purpose         :   This is a component for entering new comment and view all the comments for a case.
* @ Author          :   Rakesh Nayak
*
*   Date            |  Developer Name               |  Version      |  Changes
* ======================================================================================================
*   17-06-2022      |  rakesh.nayak@absyz.com       |  1.0          |  Initial Version
*   22-07-2022      |  vinaykant.kurre@absyz.com    |  1.1          |  Updated Styling & Edit/Delete Option.
*
-->
<template>
    <!-- lightning-spinner: Used during updation of comments after a comment is inserted -->
    <div if:true={blnIsLoading}>
        <lightning-spinner alternative-text="Loading..." variant="brand" class="slds-is-fixed">
        </lightning-spinner>
    </div>
    <!-- lightning-card: holds the casecomments -->
    <lightning-card>
        <div class="c-container slds-p-vertical_small slds-p-horizontal_small">
            <lightning-layout multiple-rows="false" vertical-align="start">
                <lightning-layout-item size="2" small-device-size="2" medium-device-size="2" large-device-size="1">
                    <lightning-avatar variant="circle" src="/bad/image/url.jpg" initials=""
                        fallback-icon-name="standard:avatar" alternative-text="">
                    </lightning-avatar>
                </lightning-layout-item>
                <lightning-layout-item size="9" small-device-size="9" medium-device-size="9" large-device-size="10">
                    <lightning-input-rich-text onchange={handleChangeComment} type="text"
                        class="nullify" value={strBody} placeholder={strPlaceHolderText}
                        variant="label-hidden" disabled-categories="INSERT_CONTENT"
                        message-when-bad-input={strErrorMessageCommentInput} valid={blnValid}>
                    </lightning-input-rich-text>
                </lightning-layout-item>
                <lightning-layout-item alignment-bump="right" class="slds-p-left_none slds-m-top_x-small" size="1" small-device-size="1"
                    medium-device-size="1" large-device-size="1">
                    <lightning-button-icon icon-name="utility:arrowup" variant="brand" onclick={handleOnClick}
                        class="del-style-button-left-margin">
                    </lightning-button-icon>
                </lightning-layout-item>
            </lightning-layout>
            
            <lightning-layout>
                <lightning-layout-item size="12" small-device-size="12" medium-device-size="12" large-device-size="12">
                    <div class="slds-var-p-top_small">
                        <template if:true={list_Comments}>
                            <div class="del-style-commentsection">
                                <template for:each={list_Comments} for:item="objCaseComment">
                                    <div key={objCaseComment.Id}
                                        class="slds-p-bottom_xxx-small slds-p-top_xx-small slds-grid slds-border_bottom">
                                        <div class="slds-col slds-grow-none slds-p-top_x-small slds-p-right_x-small">
                                            <span>
                                                <lightning-avatar variant="circle" src="/bad/image/url.jpg" initials=""
                                                    fallback-icon-name="standard:avatar" alternative-text=""
                                                    class="slds-p-right_x-small">
                                                </lightning-avatar>
                                            </span>
                                        </div>
                                        <div
                                            class="slds-col slds-medium-size_11-of-12 slds-small-size_11-of-12 slds-large-size_11-of-12 slds-p-around_x-small slds-col_bump-left">
                                            <span>
                                                <div>
                                                    <div class="slds-p-bottom_none">
                                                        <a href=""
                                                            class="del-style-username">{objCaseComment.CommentCreatedName__c}
                                                        </a>
                                                    </div>
                                                    <div class="slds-p-top_none slds-text-body_small">
                                                        <lightning-formatted-date-time
                                                            value={objCaseComment.CreatedDate} year="numeric"
                                                            day="2-digit" month="long" hour="2-digit" minute="2-digit">
                                                        </lightning-formatted-date-time>
                                                    </div>
                                                    <div class="slds-p-top_small">
                                                        <lightning-formatted-rich-text value={objCaseComment.Body__c}>
                                                        </lightning-formatted-rich-text>
                                                    </div>
                                                    <div class="slds-p-top_small">
                                                        <template if:true={objCaseComment.listAttachments}>
                                                            <lightning-layout multiple-rows="true">
                                                                <template for:each={objCaseComment.listAttachments} for:item="objFile">
                                                                    <lightning-layout-item size="12" key={objFile.ContentDocumentId} small-device-size="6" medium-device-size="6" 
                                                                        large-device-size="4" class="slds-p-vertical_xx-small slds-p-right_xx-small">
                                                                        <lightning-layout class="del-style-file-pills slds-p-around_x-small">
                                                                            <lightning-layout-item size="1">
                                                                                <span>
                                                                                    <lightning-icon icon-name="doctype:attachment" title={objFile.Title} 
                                                                                        size="x-small"></lightning-icon>
                                                                                </span>
                                                                            </lightning-layout-item>
                                                                            <lightning-layout-item size="10" class="slds-p-horizontal_xx-small">
                                                                                <span>
                                                                                    <a href={objFile.strFileURL} target="_blank">
                                                                                        {objFile.Title}.{objFile.FileExtension}
                                                                                    </a>
                                                                                </span>
                                                                            </lightning-layout-item>
                                                                            <lightning-layout-item size="1">
                                                                                <span>
                                                                                    <a href={objFile.strDownloadURL} class="del-style-download-icon">
                                                                                        <lightning-icon icon-name="utility:download" alternative-text="Download" title={objFile.Title} 
                                                                                            size="x-small"></lightning-icon>
                                                                                    </a>
                                                                                </span>
                                                                            </lightning-layout-item>
                                                                        </lightning-layout>
                                                                    </lightning-layout-item>
                                                                </template>
                                                            </lightning-layout>
                                                        </template>
                                                    </div>
                                                </div>
                                            </span>
                                        </div>
                                        <div
                                            class="slds-col slds-large-size_1-of-12 slds-small-size_1-of-12 slds-medium-size_1-of-12 slds-col_bump-left">
                                        </div>
                                    </div>
                                </template>
                            </div>
                        </template>
                    </div>
                </lightning-layout-item>
            </lightning-layout>
        </div>
    </lightning-card>
</template>